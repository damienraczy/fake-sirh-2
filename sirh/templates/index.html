<!-- sirh/templates/index.html -->
{% extends "base.html" %}

{% block content %}
<!-- Stats -->
<div class="stats-grid" id="statsGrid">
    <div class="stat-card">
        <div class="stat-value">-</div>
        <div class="stat-label">Employ√©s</div>
    </div>
    <div class="stat-card">
        <div class="stat-value">-</div>
        <div class="stat-label">D√©partements</div>
    </div>
    <div class="stat-card">
        <div class="stat-value">-</div>
        <div class="stat-label">Comp√©tences</div>
    </div>
    <div class="stat-card">
        <div class="stat-value">-</div>
        <div class="stat-label">Formations</div>
    </div>
</div>

<!-- Recherche -->
<div class="card mb-6">
    <div class="card-body">
        <div class="flex-gap">
            <input type="text" id="searchInput" class="form-input" placeholder="Rechercher...">
            <button onclick="GlobalSearch.performSearch(document.getElementById('searchInput').value, 'searchResults')" class="btn btn-primary">Rechercher</button>
        </div>
        <div id="searchResults" class="hidden mt-4"></div>
    </div>
</div>

<!-- Sections -->
<div class="grid-2">
    <div class="card">
        <div class="card-header">
            <h2 class="card-title">üë• Employ√©s</h2>
        </div>
        <div class="card-body">
            <p class="mb-4">Consulter la liste des employ√©s</p>
            <a href="/employees" class="btn btn-primary">Voir les employ√©s</a>
        </div>
    </div>
    
    <div class="card">
        <div class="card-header">
            <h2 class="card-title">üèõÔ∏è D√©partements</h2>
        </div>
        <div class="card-body">
            <p class="mb-4">Organisation par d√©partements</p>
            <a href="/departments" class="btn btn-primary">Voir les d√©partements</a>
        </div>
    </div>
    
    <div class="card">
        <div class="card-header">
            <h2 class="card-title">üéØ Comp√©tences</h2>
        </div>
        <div class="card-body">
            <p class="mb-4">R√©f√©rentiel des comp√©tences</p>
            <a href="/skills" class="btn btn-primary">Voir les comp√©tences</a>
        </div>
    </div>
    
    <div class="card">
        <div class="card-header">
            <h2 class="card-title">üéì Formations</h2>
        </div>
        <div class="card-body">
            <p class="mb-4">Programmes de formation</p>
            <a href="/training" class="btn btn-primary">Voir les formations</a>
        </div>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script>
async function loadStats() {
    try {
        const stats = await SirhAPI.getStats();
        const grid = document.getElementById('statsGrid');
        grid.innerHTML = `
            <div class="stat-card">
                <div class="stat-value">${Utils.formatNumber(stats.employees)}</div>
                <div class="stat-label">Employ√©s</div>
            </div>
            <div class="stat-card">
                <div class="stat-value">${Utils.formatNumber(stats.departments)}</div>
                <div class="stat-label">D√©partements</div>
            </div>
            <div class="stat-card">
                <div class="stat-value">${Utils.formatNumber(stats.skills)}</div>
                <div class="stat-label">Comp√©tences</div>
            </div>
            <div class="stat-card">
                <div class="stat-value">${Utils.formatNumber(stats.training_programs)}</div>
                <div class="stat-label">Formations</div>
            </div>
        `;
    } catch (error) {
        console.error('Erreur stats:', error);
    }
}

GlobalSearch.init('searchInput', 'searchResults');
loadStats();
</script>
{% endblock %}

